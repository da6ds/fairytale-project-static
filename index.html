<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>童话项目 | Fairytale Project | Fairytale-Projekt</title>
    <style>
        /* EXACT ORIGINAL CSS FROM public.css */
        
        /* RESET */
        html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,
        img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,
        caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,
        ruby,section,summary,time,mark,audio,video {
            margin:0;
            padding:0;
            border:0;
            font-size:100%;
            -webkit-text-size-adjust:100%;
            -ms-text-size-adjust:100%;
            font:inherit;
            vertical-align:baseline;
            font-family:Helvetica, Arial, Verdana, sans-serif;
            color: black;
        }

        img {
            border:0;
            -ms-interpolation-mode:bicubic;
        }

        article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section {
            display:block;
        }

        body {
            line-height:1;
            font-size:62.5%;
        }

        ol,ul {
            list-style:none;
        }

        blockquote,q {
            quotes:none;
        }

        blockquote:before,blockquote:after,q:before,q:after {
            content:'';
            content:none;
        }

        table {
            border-collapse:collapse;
            border-spacing:0;
        }

        /* BODY STYLES */
        html {
            height:100%;
            width:100%;
            overflow-x:hidden;
        }

        body {
            width:100%;
            height:100%;
            margin:0;
            padding:0;
            border:0;
            background:#fff;
            font-size:12px;
            line-height:16px;
        }

        img {
            border:none;
        }

        form {
            margin-bottom:0;
            margin-top:5px;
            margin-bottom:6px;
        }

        a {
            text-decoration:none;
            color:#000;
            font-weight:bold;
        }

        a:hover {
            color:red;
        }

        h2 {
            font-size:20px;
            font-weight:700;
            margin:5px;
            padding-bottom:8px;
            border-bottom:1px dashed #000;
            display:block;
            margin-bottom:10px;
        }

        i {
            font-style:italic;
        }

        b {
            font-weight:700;
        }

        #container {
            width:100%;
            height:auto;
            border:0;
            padding:0;
            margin:0;
        }

        /* NAVIGATION BOX */
        #headercontainer {
            position:absolute;
            position:fixed;
            top:20px;
            left:20px;
            width:250px;
            z-index:1000;
            margin:0;
            padding:0;
        }

        #navbox {
            font-size:11px;
            position:relative;
            width:270px;
            background:#fff;
            padding:5px 10px 10px;
            border:#000 2px solid;
            z-index:1000;
        }

        #navbox h3 {
            font-weight:700;
            font-size:12px;
            line-height:8px;
            margin-bottom:0px;
        }

        #navbox a{
            font-weight:normal;
        }

        #header {
            width:270px;
            height:145px;
            background-image:url('fairytale_header.png');
            background-position:center top;
            background-repeat:no-repeat;
            border-bottom:#000 1px dashed;
            margin-top:5px;
        }

        #header h1 {
            visibility:hidden;
            color:#ed1c24;
            font-size:25px;
        }

        #view {
            padding:8px 0 14px 0;
            font-weight:700;
            border-bottom:#000 1px dashed;
            margin-bottom:5px;
            width:100%;
        }

        #filters {
            padding:8px 0;
            border-bottom:#000 1px dashed;
            width:100%;
            font-size:11px;
        }

        .filter {
            width:100%;
            margin-top:10px;
        }

        #language {
            margin-top:10px;
        }
        
        #gender {
            margin-top:11px;
        }

        #region {
            margin-top:11px;
        }

        #generation {
            margin-top:11px;
        }

        #themes {
            margin-top:11px;
        }

        .header_links {
            width:100%;
            margin-top:8px;
            font-size:11px;
        }

        .header_links a {
            display:block;
            margin-bottom:0px;
        }

        #filters > p {
            margin-top:6px;
        }

        #social {
            margin:0px;
            padding:0px;
            text-align:center;
        }
        
        #social a{
            background-image:url('Fairytale_Social.png');
            text-indent: -6000px;
            display:inline-block;
            height:35px;
            width:35px;
            margin:0px;
            padding:0px 2px;
        }

        #social a.facebook {background-position:0px 0px}
        #social a.twitter {background-position:-43px 0px}
        #social a.googleplus {background-position:-86px 0px}
        #social a.tumblr {background-position:-129px 0px}
        #social a.renren {background-position:-172px 0px}
        #social a.weibo {background-position:-215px 0px}

        /* GRID */
        #participants {
            position: absolute;
            left: 0px;
            right: 0px;
            top: 0;
            height: auto;
            font-size: 12px;
            margin-top: 0;
            padding: 0;
            text-align: center;
        }

        .outer {
            display:inline-block;
            position:relative;
            width:7.4%;
            text-align:center;
            margin:1px 1px 1px 1px;
            height:auto;
            min-width: 0;
            cursor: pointer;
        }

        .outer img {
            position:relative;
            top:0;
            left:0;
            width:100%;
            height:auto;
            opacity: 0.4;  /* Put the opacity BACK on the image */
            transition: opacity 0.3s ease;
        }

        .outer:hover img {
            opacity: 1;  /* Full opacity on hover */
        }

        .outer p {
            font-size:14px;
            padding-top:40%;
        }

        .id {
            position:absolute;
            top:0;
            left: 0;
            width:100%;
            height:100%;
            text-align:center;
            font-weight:700;
            color:#4d4d4d;
            z-index:0;  /* CHANGE THIS - was 2, now 0 */
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            pointer-events: none;
            opacity: 1;  /* Force opacity to 1 */
        }

        .outer:hover .id {
            color: white;
            text-shadow: 0 0 4px rgba(0,0,0,0.8), 0 0 8px rgba(0,0,0,0.6);
        }

        /* STATS */
        .stats {
            position:fixed;
            bottom: 0px;
            background: rgba(255, 255, 255, 0.71);
            display: block;
            width: 100%;
            padding: 3px;
            text-align:center;
            font-size: 11px;
        }

        /* Modal styles */
        .modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 800px;
            border-radius: 8px;
            position: relative;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover,
        .close:focus {
            color: #000;
        }

        .modal-body {
            display: flex;
            gap: 20px;
            align-items: flex-start;
        }

        .modal-photo {
            width: 300px;
            height: auto;
            border-radius: 4px;
        }

        .modal-info {
            flex: 1;
        }

        .modal-info h2 {
            margin-top: 0;
            color: #c41e3a;
        }

        .modal-info p {
            margin: 10px 0;
        }

       .participant-photo {
            cursor: pointer;
        }

        .outer {
            /*opacity: 0.4;*/
            transition: opacity 0.3s ease;
        }

        .outer:hover {
            opacity: 1;
        }

    /* MODAL STYLES */
        .modal {
            display: none;
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border: 3px solid #000;
            width: 80%;
            max-width: 700px;
            position: relative;
        }

        .close {
            color: #000;
            position: absolute;
            right: 15px;
            top: 10px;
            f
    
    </style>
</head>
<body>
    <div id="container">
        <div id="headercontainer">
            <div id="navbox">
                <div id="header">
                    <h1>童话项目 / Fairytale Project / Fairytale-Projekt</h1>
                </div>

                <div id="view">
                    <h3>1. 选择视图 / Select View / Ansicht auswählen:<br /></h3>
                    <select class="filter" disabled>
                        <option>肖像 / Grid / Raster</option>
                    </select>
                </div>

                <div id="filters">
                    <h3>2. 选择过滤器 / Select Filters / Filter auswählen:<br /></h3>
                    
                    <select id="language" class="filter">
                        <option value="">语言 / Languages / Sprachen</option>
                        <option value="Chinese">中文</option>
                        <option value="English">English</option>
                        <option value="German">Deutsch</option>
                    </select>

                    <select id="gender" class="filter">
                        <option value="">性别 / Gender / Geschlecht</option>
                        <option value="Male">男 / Male / Männlich</option>
                        <option value="Female">女 / Female / Weiblich</option>
                    </select>

                    <select id="region" class="filter">
                        <option value="">地区 / Region / Region</option>
                        <option value="East Asia">East Asia</option>
                        <option value="North America">North America</option>
                        <option value="Europe">Europe</option>
                        <option value="Southeast Asia">Southeast Asia</option>
                    </select>

                    <select id="generation" class="filter">
                        <option value="">出生年代 / Generation / Generation</option>
                        <option value="2000s">2000-2009</option>
                        <option value="1990s">1990-1999</option>
                        <option value="1980s">1980-1989</option>
                        <option value="1970s">1970-1979</option>
                        <option value="1960s">1960-1969</option>
                        <option value="1950s">1950-1959</option>
                    </select>

                    <select id="themes" class="filter">
                        <option value="">主题 / Themes / Themen</option>
                        <option value="Family">Family</option>
                        <option value="Migration">Migration</option>
                        <option value="Love">Love</option>
                        <option value="Dreams">Dreams</option>
                    </select>

                    <p><a href="#" id="resetFilters">重设过滤器 / Reset Filters / Filter zurücksetzen</a></p>
                </div>

                <div class="header_links">
                    <a href="#">项目简介 / Project Overview / Projekt-Überblick</a>
                    <a href="#">博客 / Blog / Blog</a>
                    <a href="#">参与者召唤 / Call to Participants / An die Teilnehmenden</a>
                    <div id="social">
                        <a href="http://www.facebook.com/sharer/sharer.php?u=http://www.fairytaleproject.net" target="_blank" class="facebook">Facebook</a>
                        <a href="http://clicktotweet.com/0RVj3" target="_blank" class="twitter">Twitter</a>
                        <a href="https://plusone.google.com/_/+1/confirm?hl=en&url=http://www.fairytaleproject.net" target="_blank" class="googleplus">Google Plus</a>
                        <a href="http://www.tumblr.com/share/link?url=http://www.fairytaleproject.net&name=The%20Fairytale%20Project" target="_blank" class="tumblr">Tumblr</a>
                        <a href="http://share.renren.com/share/buttonshare.do?link=http://www.fairytaleproject.net&title=The%20Fairytale%20Project" target="_blank" class="renren">RenRen</a>
                        <a href="http://service.weibo.com/share/share.php?url=http://www.fairytaleproject.net&appkey=&title=The%20Fairytale%20Project&pic=&ralateUid=&language=zh_cn" class="weibo" target="_blank">Weibo</a>
                    </div>
                </div>
            </div>
        </div>

        <div id="participants"></div>

        <div class="stats">
            <span id="visibleCount">0</span> of <span id="totalCount">0</span> participants visible
        </div>
    </div>

    <script>
    let participants = [];

        // Load participants from JSON file
        fetch('fairytale-data.json')
            .then(response => response.json())
            .then(data => {
                participants = data;
                renderParticipants();
                setupModalHandlers();
            })
            .catch(error => {
                console.error('Error loading participant data:', error);
            });

        function renderParticipants() {
            const grid = document.getElementById('participants');
            grid.innerHTML = participants.map(p => `
                <div class="outer active" data-id="${p.id}" data-gender="${p.gender}" data-generation="${p.generation}" data-region="${p.region}" data-language="${p.language.join(',')}" data-themes="${p.themes.join(',')}">
                    ${p.photo ? `<img src="images/${p.photo}" alt="Participant ${p.id}" class="participant-photo">` : `<div class="no-photo">${p.id}</div>`}
                    <div class="id">${p.id}</div>
                </div>
            `).join('');
            updateStats();
        }
            const modal = document.getElementById('participantModal');

        function setupModalHandlers() {
            console.log('Setting up modal handlers...');
            console.log('Participants array:', participants.length);
            console.log('Grid element:', document.getElementById('participants'));
            console.log('Modal element:', document.getElementById('participantModal'));
            const closeBtn = document.querySelector('.close');
            const grid = document.getElementById('participants');
    
            console.log('Close button found:', closeBtn);

            const modal = document.getElementById('participantModal');
        
            // Click on photos to open modal
            grid.addEventListener('click', function(e) {
                console.log('Clicked on:', e.target, 'Classes:', e.target.classList);
                if  (e.target.classList.contains('participant-photo') || 
                    e.target.classList.contains('id') || 
                    e.target.classList.contains('outer')) {
                        const card = e.target.closest('.outer');
                        const participantId = card.dataset.id;
                        const participant = participants.find(p => p.id === participantId);
                
                if (participant) {
                    showModal(participant);
                    }
                }
            });
        
            // Close button
            closeBtn.onclick = function() {
                modal.style.display = 'none';
            }
        
            // Click outside modal to close
            window.onclick = function(event) {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            }
        }

        function showModal(participant) {
            const modal = document.getElementById('participantModal');  // Add this line
            document.getElementById('modalPhoto').src = participant.photo ? `images/${participant.photo}` : '';
            document.getElementById('modalPhoto').alt = `Participant ${participant.id}`;
            document.getElementById('modalId').textContent = `Participant ${participant.id}`;
            document.getElementById('modalGender').textContent = participant.gender;
            document.getElementById('modalYear').textContent = participant.year;
            document.getElementById('modalGeneration').textContent = participant.generation;
            document.getElementById('modalRegion').textContent = participant.region;
            document.getElementById('modalThemes').textContent = participant.themes.join(', ');
        
            modal.style.display = 'block';
        }

        function filterParticipants() {
            const genderFilter = document.getElementById('gender').value;
            const regionFilter = document.getElementById('region').value;
            const generationFilter = document.getElementById('generation').value;
            const languageFilter = document.getElementById('language').value;
            const themesFilter = document.getElementById('themes').value;

            const cards = document.querySelectorAll('.outer');
        
            cards.forEach(card => {
                const gender = card.dataset.gender;
                const region = card.dataset.region;
                const generation = card.dataset.generation;
                const languages = card.dataset.language.split(',');
                const themes = card.dataset.themes.split(',');

                const matchesGender = !genderFilter || gender === genderFilter;
                const matchesRegion = !regionFilter || region === regionFilter;
                const matchesGeneration = !generationFilter || generation === generationFilter;
                const matchesLanguage = !languageFilter || languages.includes(languageFilter);
                const matchesThemes = !themesFilter || themes.includes(themesFilter);

                if (matchesGender && matchesRegion && matchesGeneration && matchesLanguage && matchesThemes) {
                    card.classList.remove('inactive');
                    card.classList.add('active');
                } else {
                    card.classList.remove('active');
                    card.classList.add('inactive');
                }
            });

            updateStats();
        }

        function updateStats() {
            const total = document.querySelectorAll('.outer').length;
            const visible = document.querySelectorAll('.outer.active').length;
            document.getElementById('totalCount').textContent = total;
            document.getElementById('visibleCount').textContent = visible;
        }

        function resetFilters() {
            document.getElementById('gender').value = '';
            document.getElementById('region').value = '';
            document.getElementById('generation').value = '';
            document.getElementById('language').value = '';
            document.getElementById('themes').value = '';
            filterParticipants();
        }

        document.getElementById('gender').addEventListener('change', filterParticipants);
        document.getElementById('region').addEventListener('change', filterParticipants);
        document.getElementById('generation').addEventListener('change', filterParticipants);
        document.getElementById('language').addEventListener('change', filterParticipants);
        document.getElementById('themes').addEventListener('change', filterParticipants);
        document.getElementById('resetFilters').addEventListener('click', (e) => {
            e.preventDefault();
            resetFilters();
        });
</script>

    <!-- Participant Detail Modal -->
<div id="participantModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <div class="modal-body">
            <img id="modalPhoto" src="" alt="" class="modal-photo">
            <div class="modal-info">
                <h2 id="modalId"></h2>
                <p><strong>Gender:</strong> <span id="modalGender"></span></p>
                <p><strong>Year:</strong> <span id="modalYear"></span></p>
                <p><strong>Generation:</strong> <span id="modalGeneration"></span></p>
                <p><strong>Region:</strong> <span id="modalRegion"></span></p>
                <p><strong>Themes:</strong> <span id="modalThemes"></span></p>
            </div>
        </div>
    </div>
</div>

</body>
</html>